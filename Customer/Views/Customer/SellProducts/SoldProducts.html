<OnlineTechShop.Models.Old_Products>
    <!DOCTYPE html>
    <html lang="en">

    <head>
        <meta charset="utf-8">
        <meta content="width=device-width, initial-scale=1.0" name="viewport">
        <title>Sold Products</title>
        <meta content="" name="descriptison">
        <meta content="" name="keywords">


        <link href="../../../Contents/vendor/img/apple-touch-icon.png" rel="apple-touch-icon">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">
        <link href="../../../Contents/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
        <link href="../../../Contents/vendor/icofont/icofont.min.css" rel="stylesheet">
        <link href="../../../Contents/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
        <link href="../../../Contents/vendor/remixicon/remixicon.css" rel="stylesheet">
        <link href="../../../Contents/vendor/venobox/venobox.css" rel="stylesheet">
        <link href="../../../Contents/vendor/owl.carousel/assets/owl.carousel.min.css" rel="stylesheet">
        <link href="../../../Contents/vendor/aos/aos.css" rel="stylesheet">
        <link href="../../../Contents/CSS_Files/style.css" rel="stylesheet">
        <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css">

        <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css">
        <script src="//code.jquery.com/jquery-1.12.4.js"></script>
        <script src="//code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
        <link href="https://code.jquery.com/ui/1.10.4/themes/ui-lightness/jquery-ui.css" rel="stylesheet">
        <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

        <style>
            .featured-item-box {
                min-height: 150px;
                background: #3b555d;
                min-width: 80px;
                color: white;
                border-radius: 5px;
                padding-top: 30px;
            }
        </style>
    </head>

    <body>
        <header id="header" class="">
            <div class="container">
                <div class="row justify-content-center">
                    <div class="col-12 col-lg-6">
                        <h1 class="logo"><a href="../Home/Index.html" class="text-success">Online Tech Shop</a></h1>
                    </div>
                    <div class="col-lg-6 col-12">
                        <a href="../Cart/Index.html" class="btn btn-light btn-sm">
                            <i class="icofont-cart-alt h6"> Cart <span class="badge badge-danger" id="cartQuantity">0</span> </i>
                        </a> | <a href="../Products/CompareProducts.html" class="btn-sm  btn-info">Compare Products</a>
                        <a href="../SellProducts/Index.html" class="btn-sm btn-warning">Sell Products</a> <a href="../CustomerProfile/Index.html" class="btn-sm btn-success showToLogginInCustomer">My Account</a> <a class="text-light showToLogginInCustomer btn-sm btn-danger"
                            id="logOutBtn">Logout</a>
                        <a href="../CustomerRegistration/Index.html" class="btn-sm btn-success hideToLogginInCustomer">Register</a> <a href="../CustomerLogin/Index.html" class="btn-sm btn-primary hideToLogginInCustomer">Login</a>
                    </div>
                    <div class="col-12 col-lg-8 text-center">
                        <input class="form-control" id="searchBox" name="searchtext" placeholder="Search Products..." type="text">
                    </div>
                </div>
            </div>
        </header>
        <!-- End Header -->
        <!--Main Body Starts-->
        <main id="main ">
            <div class="container">
                <div class="row mt-2 justify-content-center">
                    <div class="col-12 col-lg-5 rounded bg-dark">
                        <a href="Index.html" class="btn btn-outline-dark text-light">Sell Proudct</a>
                        <a href="PendingSellPosts.html" class="btn btn-outline-dark text-light">Pending Sell Posts</a>
                        <a href="SoldProducts.html" class="btn btn-outline-dark text-light">Sold Items</a>
                    </div>
                    <div class="col-12 text-center">
                        <div id="donutchart" style="width: 900px; height: 500px;"></div>
                    </div>
                    <div class="col-10">
                        <h2 class="border-bottom mb-4 text-center">Sold Products Report</h2>
                        <span class="text-danger h4 msg"></span><br />
                        <input type="hidden" id="customInput" data-value="@ViewBag.soldData" />
                        <table class="table table-bordered table-striped table-secondary" id="soldTable">
                            <thead>
                                <tr class="bg-light">
                                    <td colspan="8">Date : </td>
                                </tr>
                                <tr>
                                    <th>Product ID</th>
                                    <th>Proudct Name</th>
                                    <th>Category</th>
                                    <th>Brand</th>
                                    <th>Asking Price</th>
                                    <th>Image</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                            </tbody>
                        </table>
                        <button class="btn btn-sm btn-primary btn-block" id="downloadAllSoldDataBtn">Download Excel</button>
                        <button class="btn btn-sm btn-success btn-block" id="downloadAllSoldDataBtnPDF" onclick="generate()">Download PDF</button>
                    </div>
                </div>
            </div>

        </main>

        <!-- ======= Footer ======= -->
        <footer id="footer">
            <div class="container d-md-flex py-4">
                <div class="mr-md-auto text-center text-md-left">
                    <div class="credits">
                        Call Us: <b><i>01xxxxxxxx</i></b><br> Emal: <b><i>onlinetechshop@gmail.com</i></b><br> Address: <b><i>Dhaka, Bangladesh</i></b><br>
                    </div>
                </div>
                <div class="social-links text-center text-md-right pt-3 pt-md-0">
                    <a href="#" class="twitter"><i class="bx bxl-twitter"></i></a>
                    <a href="#" class="facebook"><i class="bx bxl-facebook"></i></a>
                    <a href="#" class="instagram"><i class="bx bxl-instagram"></i></a>
                    <a href="#" class="google-plus"><i class="bx bxl-skype"></i></a>
                    <a href="#" class="linkedin"><i class="bx bxl-linkedin"></i></a>
                </div>
            </div>
        </footer>
        <a href="#" class="back-to-top"><i class="ri-arrow-up-line"></i></a>
        <div id="preloader"></div>
        <script src="../../../Contents/vendor/jquery/jquery.min.js"></script>
        <script src="../../../Contents/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
        <script src="../../../Contents/vendor/jquery.easing/jquery.easing.min.js"></script>
        <script src="../../../Contents/vendor/php-email-form/validate.js"></script>
        <script src="../../../Contents/vendor/waypoints/jquery.waypoints.min.js"></script>
        <script src="../../../Contents/vendor/counterup/counterup.min.js"></script>
        <script src="../../../Contents/vendor/venobox/venobox.min.js"></script>
        <script src="../../../Contents/vendor/owl.carousel/owl.carousel.min.js"></script>
        <script src="../../../Contents/vendor/isotope-layout/isotope.pkgd.min.js"></script>
        <script src="../../../Contents/vendor/aos/aos.js"></script>
        <script src="../../../Contents/Scripts_Files/main.js"></script>
        <script src="../../../Contents/Scripts_Files/productSearch.js"></script>
        <script src="../../../Contents/Scripts/Customer/customerLoggedInCheck.js"></script>
        <script src="../../../Contents/Scripts/Customer/soldProducts.js"></script>
        <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous">
        </script>
        <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
        <script src="../../../Contents/Scripts/Customer/customerLoggedInState.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous">
        </script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
        <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
        <script src="https://code.jquery.com/ui/1.10.4/jquery-ui.js"></script>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.6/jspdf.plugin.autotable.min.js"></script>

        <script src="../../../Contents/Scripts_Files/jquery.table2excel.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/js-cookie@rc/dist/js.cookie.min.js"></script>

        <script>
            $("#downloadAllSoldDataBtn").click(function() {
                $("#soldTable").table2excel({
                    exclude: ".noExl",
                    name: "Worksheet Name",
                    filename: "Products Sold Data",
                    fileext: ".xls",
                    exclude_img: false,
                    exclude_links: true,
                    exclude_inputs: true
                });
            });
        </script>

        <script type="text/javascript">
            function generate() {
                var doc = new jsPDF('p', 'pt', 'letter');
                var htmlstring = '';
                var tempVarToCheckPageHeight = 0;
                var pageHeight = 0;
                pageHeight = doc.internal.pageSize.height;
                specialElementHandlers = {
                    // element with id of "bypass" - jQuery style selector
                    '#bypassme': function(element, renderer) {
                        // true = "handled elsewhere, bypass text extraction"
                        return true
                    }
                };
                margins = {
                    top: 150,
                    bottom: 60,
                    left: 40,
                    right: 40,
                    width: 600
                };
                $("tr").each(function() {
                    $(this).children("td:eq(7)").remove();
                    $(this).children("th:eq(7)").remove();
                });
                var y = 20;
                doc.setLineWidth(2);
                doc.text(200, y = y + 30, "Total Sold Prouducts");
                doc.autoTable({
                    html: '#soldTable',
                    startY: 70,
                    theme: 'grid',
                    styles: {
                        minCellHeight: 40
                    }
                })
                doc.save('Sold_Products.pdf');
            }
        </script>
    </body>

    </html>